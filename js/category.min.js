(()=>{"use strict";const e=e=>JSON.parse(localStorage.getItem(e))||[],t=document.querySelector(".header__menu-button"),a=document.querySelector(".menu");t.addEventListener("click",(()=>{t.classList.toggle("header__menu-button_close"),a.classList.toggle("menu_active")})),(()=>{const t=e("cart").reduce(((e,t)=>e+t.quantity),0);document.querySelector(".header__link_cart").dataset.total=t})();const c=document.querySelectorAll(".footer__list_cover");document.querySelectorAll(".footer__button").forEach(((e,t)=>{e.addEventListener("click",(()=>{e.classList.toggle("footer__button_active");for(let e=0;e<c.length;e++)t===e&&c[e].classList.toggle("footer__list_active")}))}));const n=e=>{const t=document.createElement("li");t.className="footer__item";const a=document.createElement("a");return a.className="footer__link",a.href="category.html?search="+e,a.textContent=e,t.append(a),t},o=e=>{const t=document.createElement("li");t.className="menu__item";const a=document.createElement("a");return a.className="menu__link",a.href="category.html?search="+e,a.textContent=e,t.append(a),t};(async()=>{const e=await(async()=>{const e=await fetch("https://shorthaired-veiled-fascinator.glitch.me/api/category");return await e.json()})(),t=document.querySelector(".footer__list_two-cols"),a=document.querySelector(".menu__list_two-cols");t.append(...e.map(n)),a.append(...e.map(o))})();const s=e=>"image/notimage.jpg"===e?"./img/no-image.png":`https://shorthaired-veiled-fascinator.glitch.me/${e}`,r=({id:e,title:t,price:a,discount:c,image:n})=>{const o=document.createElement("li");o.className="card",o.tabIndex="0";const r=s(n);var l;return o.innerHTML=`\n  <a href="product.html?id=${e}" class="card__link">\n    <div class="card__image-wrapper">\n      <img src="${r}" alt="${t}" class="card__image" width="420" height="295">\n      ${c>0?`<div class="card__discount">-${c}%</div>`:""}\n    </div>\n  \n    <div class="card__price">\n      <p class="card__new-price">${l=((e,t,a)=>t*(e-e*a/100))(a,1,c),Math.round(100*l)/100+" ₽"}</p>\n      ${c>0?`\n      <p class="card__old-price">\n        <span class="visually-hidden">Старая цена</span>${a} ₽\n      </p>\n      `:""}\n    </div>\n  \n    <p class="card__product">${t}</p>\n  </a>\n  `,o},l="https://shorthaired-veiled-fascinator.glitch.me",i=async()=>{const e=await fetch(`${l}/api/goods`);return await e.json()};(async()=>{const e=new URL(window.location.href).searchParams.get("search"),t=await(async e=>(await i()).filter((t=>t.category.toLowerCase().startsWith(e.toLowerCase()))))(e),a=document.querySelector(".category-goods__container"),c=document.createElement("h1");c.className="subtitle",c.textContent=e;const n=document.createElement("ul");n.className="category-goods__list";const o=t.map(r);n.append(...o),a.append(c,n)})()})();