(()=>{"use strict";const e=e=>JSON.parse(localStorage.getItem(e))||[],t=document.querySelector(".header__menu-button"),n=document.querySelector(".menu");t.addEventListener("click",(()=>{t.classList.toggle("header__menu-button_close"),n.classList.toggle("menu_active")})),(()=>{const t=e("cart").reduce(((e,t)=>e+t.quantity),0);document.querySelector(".header__link_cart").dataset.total=t})();const s=document.querySelectorAll(".footer__list_cover");document.querySelectorAll(".footer__button").forEach(((e,t)=>{e.addEventListener("click",(()=>{e.classList.toggle("footer__button_active");for(let e=0;e<s.length;e++)t===e&&s[e].classList.toggle("footer__list_active")}))}));const r=e=>{const t=document.createElement("li");t.className="footer__item";const n=document.createElement("a");return n.className="footer__link",n.href="category.html?search="+e,n.textContent=e,t.append(n),t},a=e=>{const t=document.createElement("li");t.className="menu__item";const n=document.createElement("a");return n.className="menu__link",n.href="category.html?search="+e,n.textContent=e,t.append(n),t};(async()=>{const e=await(async()=>{const e=await fetch("http://shorthaired-veiled-fascinator.glitch.me/api/category");return await e.json()})(),t=document.querySelector(".footer__list_two-cols"),n=document.querySelector(".menu__list_two-cols");t.append(...e.map(r)),n.append(...e.map(a))})();const c=document.querySelector("[data-timer-deadline]");if(c){const e=new Date(c.dataset.timerDeadline).getTime();c.classList.add("timer"),c.innerHTML='\n    <p class="timer__title">До конца акции:</p>\n    <div class="timer__list">\n      <p class="timer__item timer__item_days">\n        <span class="timer__counter timer__counter_days"></span>\n        <span class="timer__units timer__units_days"></span>\n      </p>\n      <p class="timer__item timer__item_hours">\n        <span class="timer__counter timer__counter_hours"></span>\n        <span class="timer__units timer__units_hours"></span>\n      </p>\n      <p class="timer__item timer__item_minutes">\n        <span class="timer__counter timer__counter_minutes"></span>\n        <span class="timer__units timer__units_minutes"></span>\n      </p>\n      <p class="timer__item timer__item_seconds">\n        <span class="timer__counter timer__counter_seconds"></span>\n        <span class="timer__units timer__units_seconds"></span>\n      </p>\n    </div>\n  ';const t=c.querySelector(".timer__counter_days"),n=c.querySelector(".timer__counter_hours"),s=c.querySelector(".timer__counter_minutes"),r=c.querySelector(".timer__counter_seconds"),a=c.querySelector(".timer__units_days"),i=c.querySelector(".timer__units_hours"),o=c.querySelector(".timer__units_minutes"),_=c.querySelector(".timer__units_seconds"),m=()=>{const t=Date.now()+60*(180+(new Date).getTimezoneOffset())*1e3,n=e-t;return{timeRemaining:n,seconds:Math.floor(n/1e3%60),minutes:Math.floor(n/1e3/60%60),hours:Math.floor(n/1e3/60/60%24),days:Math.floor(n/1e3/60/60/24)}},l=(e,t)=>e>10&&e<20?"day"===t?"дней":"hours"===t?"часов":"minutes"===t?"минут":"секунд":e%10==1?"day"===t?"день":"hours"===t?"час":"minutes"===t?"минута":"секунда":e%10==2||e%10==3||e%10==4?"day"===t?"дня":"hours"===t?"часа":"minutes"===t?"минуты":"секунды":"day"===t?"дней":"hours"===t?"часов":"minutes"===t?"минут":"секунд",u=()=>{const e=m();e.days<=0&&(document.querySelector(".timer__item_days").style.display="none",document.querySelector(".timer__item_seconds").style.display="flex"),t.textContent=e.days,a.textContent=l(e.days,"day"),n.textContent=e.hours>9?e.hours:"0"+e.hours,i.textContent=l(e.hours,"hours"),s.textContent=e.minutes>9?e.minutes:"0"+e.minutes,o.textContent=l(e.minutes,"minutes"),r.textContent=e.seconds>9?e.seconds:"0"+e.seconds,_.textContent=l(e.seconds,"seconds");const d=setTimeout(u,1e3);e.timeRemaining<=0&&(clearTimeout(d),c.innerHTML="")};u()}const i=e=>"image/notimage.jpg"===e?"./img/no-image.png":`http://shorthaired-veiled-fascinator.glitch.me/${e}`,o=({id:e,title:t,price:n,discount:s,image:r})=>{const a=document.createElement("li");a.className="card";const c=i(r);var o;return a.innerHTML=`\n  <a href="product.html?id=${e}" class="card__link">\n    <div class="card__image-wrapper">\n      <img src="${c}" alt="${t}" class="card__image" width="420" height="295">\n      ${s>0?`<div class="card__discount">-${s}%</div>`:""}\n    </div>\n  \n    <div class="card__price">\n      <p class="card__new-price">${o=((e,t,n)=>t*(e-e*n/100))(n,1,s),`${o.toFixed(2)} ₽`} ₽</p>\n      ${s>0?`\n      <p class="card__old-price">\n        <span class="visually-hidden">Старая цена</span>${n} ₽\n      </p>\n      `:""}\n    </div>\n  \n    <p class="card__product">${t}</p>\n  </a>\n  `,a},_="http://shorthaired-veiled-fascinator.glitch.me",m=async()=>{const e=await fetch(`${_}/api/goods`);return await e.json()};(async()=>{const e=document.querySelector(".profit__container"),t=await(async()=>(await m()).filter((e=>e.discount>0)))(),n=document.createElement("h2");n.className="subtitle",n.textContent="Это выгодно!";const s=document.createElement("ul");s.className="profit__list";const r=t.map(o);s.append(...r),e.append(n,s)})()})();